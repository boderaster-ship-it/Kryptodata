<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Crypto & Stocks Capture PWA</title>
<link rel="manifest" href="./manifest.webmanifest">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="apple-touch-icon" href="icon-192.png">
<link rel="icon" href="icon-192.png">
<link rel="stylesheet" href="./style.css">
</head>
<body>
<header class="topbar">
  <div class="title">ðŸ“ˆ Data Capture Pro</div>
  <button id="installBtn" class="btn ghost" hidden>Zum Homescreen</button>
</header>

<main class="wrap">
  <section class="card">
    <h2>Einstellungen</h2>

    <!-- Krypto-Settings -->
    <div class="row">
      <label class="field">
        <span>Zeitraum (Krypto)</span>
        <select id="rangeCryptoSel">
          <option value="12h">12 Std.</option>
          <option value="1d" selected>1 Tag</option>
          <option value="7d">7 Tage</option>
          <option value="14d">14 Tage</option>
          <option value="30d">30 Tage</option>
          <option value="max">Maximal</option>
        </select>
      </label>
      <label class="field">
        <span>Datenabstand (Krypto)</span>
        <select id="intervalCryptoSel" title="GranularitÃ¤t je Quelle">
          <option value="1m">1 Min</option>
          <option value="2m">2 Min</option>
          <option value="5m" selected>5 Min</option>
          <option value="15m">15 Min</option>
          <option value="30m">30 Min</option>
          <option value="1h">1 Std</option>
          <option value="4h">4 Std</option>
          <option value="1d">1 Tag</option>
          <option value="1w">1 Woche</option>
        </select>
      </label>
    </div>
    <small class="hint" id="cryptoHint">
      Krypto-Preise: CoinGecko (USD) und/oder Binance (USDT â‰ˆ USD). Alle Daten werden auf deinen gewÃ¤hlten Datenabstand gebucketet.
    </small>

    <hr style="border:none;border-top:1px solid #20252e;margin:12px 0">

    <!-- Aktien/ETF optional (Beta; ohne API-Key) -->
    <div class="row">
      <label class="field" style="min-width:200px">
        <span>Aktien & ETF (Beta)</span>
        <div>
          <input id="equityEnable" type="checkbox">
          <label for="equityEnable">Aktivieren (freie Quellen: Yahoo Finance via Proxy, Stooq)</label>
        </div>
      </label>
      <label class="field">
        <span>Zeitraum (Aktien)</span>
        <select id="rangeEquitySel" disabled>
          <option value="12h">12 Std.</option>
          <option value="1d" selected>1 Tag</option>
          <option value="7d">7 Tage</option>
          <option value="14d">14 Tage</option>
          <option value="30d">30 Tage</option>
          <option value="max">Maximal</option>
        </select>
      </label>
      <label class="field">
        <span>Datenabstand (Aktien)</span>
        <select id="intervalEquitySel" disabled>
          <option value="1m">1 Min</option>
          <option value="2m">2 Min</option>
          <option value="5m" selected>5 Min</option>
          <option value="15m">15 Min</option>
          <option value="30m">30 Min</option>
          <option value="1h">1 Std</option>
          <option value="4h">4 Std</option>
          <option value="1d">1 Tag</option>
          <option value="1w">1 Woche</option>
        </select>
      </label>
    </div>
    <small class="hint" id="equityHint">
      Hinweis: Wenn deaktiviert, werden alle Aktien/ETF-Funktionen ausgeblendet. Ohne API-Key nur freie Quellen.
    </small>
  </section>

  <section class="card">
    <div class="tabs">
      <button class="tab active" data-tab="crypto">Krypto</button>
      <button class="tab" data-tab="equity">Aktien & ETF</button>
    </div>

    <div class="tabpanes">
      <div class="pane active" id="pane-crypto">
        <div class="searchbar">
          <input id="qCrypto" type="search" inputmode="search" placeholder="Krypto suchen (live)â€¦">
        </div>
        <ul id="cryptoResults" class="results"></ul>
      </div>

      <div class="pane" id="pane-equity">
        <div class="searchbar">
          <input id="qEquity" type="search" inputmode="search" placeholder="Aktien/ETF/Fonds suchen (live)â€¦" disabled>
        </div>
        <ul id="equityResults" class="results"></ul>
      </div>
    </div>
  </section>

  <section class="card">
    <h2>Auswahl</h2>
    <div id="selectedChips" class="chips"></div>
    <div class="row actions">
      <button id="loadBtn" class="btn primary">Preisdaten laden</button>
      <button id="analyzeBtn" class="btn">Lead/Lag-Analyse</button>
      <button id="exportBtn" class="btn">Export (.csv)</button>
      <button id="directDownloadBtn" class="btn ghost" hidden>Direkt-Download (.csv)</button>
      <button id="resetBtn" class="btn danger ghost">Reset</button>
    </div>
    <div id="status" class="status"></div>
    <div id="currencyNote" class="hint" style="margin-top:6px"></div>
    <div id="preview" class="tableWrap"></div>
    <div id="analysis" class="status" style="margin-top:10px"></div>
  </section>
</main>

<footer class="footer">PWA â€¢ Offline â€¢ IndexedDB Cache â€¢ Standalone auf iPhone</footer>

<!-- Wichtig: nur EIN Modul laden -->
<script type="module" src="./app.js"></script>
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js');
  }
</script>
</body>
</html>
